---
title: "Exploratory Data Analysis with Pawpaw Miller"
author: "Ian Kahrilas"
date: "1/21/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
# load in dataset
per_erp <- read_csv("per_erp.csv")
library(pander)
library(ggpubr)
library(car)
```

# Univariate Analyses

## Variables
The following variables are a part of the dataset used for PER

```{r variables for PER, echo = TRUE}
matrix(names(per_erp), ncol = 2)
```

## Descriptive Statistics

### Questionnaire descriptive statisitcs
```{r descriptive stats on variables of interest}
per_erp %>% 
  summarize("PA Mean" = mean(pos_affectivity, na.rm = TRUE),
            "PA SD" = sd(pos_affectivity, na.rm = TRUE),
            "NA Mean" = mean(neg_affectivity, na.rm = TRUE),
            "NA SD" = sd(neg_affectivity, na.rm = TRUE),
            "StM Mean" = mean(savoring_moment, na.rm = TRUE),
            "StM SD" = sd(savoring_moment, na.rm = TRUE),
            "Anticipating Mean" = mean(anticipating, na.rm = TRUE),
            "Anticipating SD" = sd(anticipating, na.rm = TRUE),
            "Reminiscing Mean" = mean(reminiscing, na.rm = TRUE),
            "Reminiscing SD" = sd(reminiscing, na.rm = TRUE)) %>% 
  pander(split.tables = 200, caption = "PA = Positive Affectivity, NA = Negative Affectivity, StM = Savoring the Moment")
```

### LPP Descriptive Statistics by Block
```{r}
per_erp %>% 
  group_by(block) %>% 
  summarize("LPP Mean" = mean(LPP, na.rm = TRUE),
            "LPP SD" = sd(LPP, na.rm = TRUE)) %>% 
  pander()
```

## PANAS

Visualized the distribution and QQ plot of PANAS

```{r PA histogram}
per_erp %>% 
  group_by(pid) %>% 
  summarize(pos_affectivity = mean(pos_affectivity, na.rm = TRUE)) %>% 
  ggplot(., (aes(pos_affectivity))) +
    geom_histogram(bins = 31) +
    ggtitle("PA Histogram")
```
```{r PA QQplot}
per_erp %>% 
  group_by(pid) %>% 
  summarize(pos_affectivity = mean(pos_affectivity, na.rm = TRUE)) %>% 
  ggplot(., aes(sample = pos_affectivity)) + 
  stat_qq() +
  stat_qq_line() +
  ggtitle("PA QQPlot")
```

It would appear that there is a slight negative skew to the data, though it does not deviate from a gaussian distribution substantially. Let's confirm with a shapiro-wilk test for normality

```{r shapiro-wilk test for positive affectivity, echo = TRUE}
pid_pa <- per_erp %>% 
  group_by(pid) %>% 
  summarize(pos_affectivity = mean(pos_affectivity, na.rm = TRUE))
shapiro.test(pid_pa$pos_affectivity) %>% 
  pander()
rm(pid_pa)
```
It is not significant, suggesting that the distribution of PA does not significantly deviate from the normal distribution.
```{r negative affectivity histogram}
per_erp %>% 
  group_by(pid) %>% 
  summarize(neg_affectivity = mean(neg_affectivity, na.rm = TRUE)) %>% 
  ggplot(., (aes(neg_affectivity))) +
    geom_histogram(bins = 25) +
    ggtitle("NA Histogram")
```
```{r negative affectivity qqplot}
per_erp %>% 
  group_by(pid) %>% 
  summarize(neg_affectivity = mean(neg_affectivity, na.rm = TRUE)) %>% 
  ggplot(., aes(sample = neg_affectivity)) + 
  stat_qq() +
  stat_qq_line() +
  ggtitle("NA QQPlot")
```
```{r shapiro-wilk test for NA}
pid_na <- per_erp %>% 
  group_by(pid) %>% 
  summarize(neg_affectivity = mean(neg_affectivity, na.rm = TRUE))
shapiro.test(pid_na$neg_affectivity) %>% 
  pander()
rm(pid_na)
```
NA does not significantly deviate from the normal distribution

```{r}

```
## Savoring the Moment
```{r StM histogram}
per_erp %>% 
  group_by(pid) %>% 
  summarize(savoring_moment = mean(savoring_moment, na.rm = TRUE)) %>% 
  ggplot(., (aes(savoring_moment))) +
    geom_histogram(bins = 25) +
    ggtitle("Savoring the Moment Histogram")
```
```{r StM qqplot}
per_erp %>% 
  group_by(pid) %>% 
  summarize(savoring_moment = mean(savoring_moment, na.rm = TRUE)) %>% 
  ggplot(., aes(sample = savoring_moment)) + 
  stat_qq() +
  stat_qq_line() +
  ggtitle("Savoring the Moment QQPlot")
```
```{r shapiro-wilk test for StM}
pid_StM <- per_erp %>% 
  group_by(pid) %>% 
  summarize(savoring_moment = mean(savoring_moment, na.rm = TRUE))
shapiro.test(pid_StM$savoring_moment) %>% 
  pander()
rm(pid_StM)
```
